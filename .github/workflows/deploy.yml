name: Deploy to GitHub Pages

on:
  push:
    branches: [ master ]
  pull_request:
    branches: [ master ]

# Sets permissions of the GITHUB_TOKEN to allow deployment to GitHub Pages
permissions:
  contents: read
  pages: write
  id-token: write

# Allow only one concurrent deployment, skipping runs queued between the run in-progress and latest queued.
# However, do NOT cancel in-progress runs as we want to allow these production deployments to complete.
concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  # Build job
  build:
    runs-on: ubuntu-latest
    
    steps:
      - name: Checkout
        uses: actions/checkout@v4
        
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '18'
          cache: 'npm'
          cache-dependency-path: './package-lock.json'
          
      # For now, just create a simple index.html since we don't have React app yet
      - name: Create placeholder site
        run: |
          mkdir -p dist
          cat > dist/index.html << 'EOF'
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>40+ Pickleball Platform</title>
              <style>
                  body {
                      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
                      line-height: 1.6;
                      max-width: 800px;
                      margin: 0 auto;
                      padding: 2rem;
                      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
                      min-height: 100vh;
                      color: white;
                  }
                  .container {
                      background: rgba(255, 255, 255, 0.1);
                      padding: 2rem;
                      border-radius: 15px;
                      backdrop-filter: blur(10px);
                      box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
                  }
                  h1 { color: #fff; text-align: center; margin-bottom: 1rem; }
                  h2 { color: #f0f0f0; border-bottom: 2px solid #f0f0f0; padding-bottom: 0.5rem; }
                  .status { padding: 1rem; background: rgba(255, 255, 255, 0.1); border-radius: 8px; margin: 1rem 0; }
                  .completed { background: rgba(76, 175, 80, 0.3); }
                  .in-progress { background: rgba(255, 193, 7, 0.3); }
                  ul { list-style-type: none; padding: 0; }
                  li { padding: 0.5rem; margin: 0.5rem 0; background: rgba(255, 255, 255, 0.05); border-radius: 5px; }
                  .badge { display: inline-block; padding: 0.25rem 0.5rem; border-radius: 12px; font-size: 0.8rem; margin-left: 0.5rem; }
                  .badge.done { background: #4caf50; }
                  .badge.progress { background: #ff9800; }
                  .badge.pending { background: #757575; }
                  a { color: #81c784; text-decoration: none; }
                  a:hover { text-decoration: underline; }
              </style>
          </head>
          <body>
              <div class="container">
                  <h1>🏓 40+ Pickleball Platform</h1>
                  
                  <div class="status completed">
                      <h2>✅ Project Status: Foundation Complete</h2>
                      <p>The technical foundation for the 40+ Pickleball tournament management platform has been successfully established!</p>
                  </div>
          
                  <h2>📋 Development Progress</h2>
                  
                  <h3>✅ Completed Milestones</h3>
                  <ul>
                      <li>📄 Product Requirements Document <span class="badge done">DONE</span></li>
                      <li>🗺️ Implementation Roadmap <span class="badge done">DONE</span></li>
                      <li>📐 Technical Specifications <span class="badge done">DONE</span></li>
                      <li>🗄️ Database Schema & Design <span class="badge done">DONE</span></li>
                      <li>🔗 Database Connection Verified <span class="badge done">DONE</span></li>
                      <li>📚 Comprehensive TODO Guide <span class="badge done">DONE</span></li>
                      <li>🚀 GitHub Repository & Pages Setup <span class="badge done">DONE</span></li>
                  </ul>
          
                  <h3>🔄 Next Phase: Week 1 Implementation</h3>
                  <ul>
                      <li>⚛️ React + TypeScript + Vite Project <span class="badge pending">PENDING</span></li>
                      <li>🎨 Tailwind CSS Design System <span class="badge pending">PENDING</span></li>
                      <li>🔐 Authentication System <span class="badge pending">PENDING</span></li>
                      <li>🧭 React Router Navigation <span class="badge pending">PENDING</span></li>
                      <li>📱 Responsive UI Components <span class="badge pending">PENDING</span></li>
                  </ul>
          
                  <h2>🏗️ Technical Architecture</h2>
                  <ul>
                      <li><strong>Frontend:</strong> React 18+ with TypeScript, Vite, Tailwind CSS</li>
                      <li><strong>Backend:</strong> Supabase (PostgreSQL, Auth, Real-time)</li>
                      <li><strong>Deployment:</strong> GitHub Pages with automated CI/CD</li>
                      <li><strong>Database:</strong> 11 tables with comprehensive security policies</li>
                  </ul>
          
                  <h2>🎯 Platform Features (Planned)</h2>
                  <ul>
                      <li>🏓 Round-robin tournament generation with advanced algorithms</li>
                      <li>👥 Player roster management with check-in system</li>
                      <li>📱 Mobile-optimized score entry for courtside use</li>
                      <li>🏆 Real-time standings with multi-tier tiebreakers</li>
                      <li>🖨️ Print-friendly schedules and standings</li>
                      <li>📊 Player statistics and performance tracking</li>
                  </ul>
          
                  <div class="status in-progress">
                      <h2>🚧 Development Timeline</h2>
                      <p><strong>Week 1-2:</strong> Authentication & Event Management<br>
                      <strong>Week 3:</strong> Tournament Algorithm Implementation<br>
                      <strong>Week 4:</strong> Score Entry & Statistics<br>
                      <strong>Week 5-6:</strong> Mobile Optimization & Deployment</p>
                  </div>
          
                  <p style="text-align: center; margin-top: 2rem;">
                      <a href="https://github.com/routaran/40pluspickleball" target="_blank">
                          📂 View Repository on GitHub
                      </a>
                  </p>
              </div>
          </body>
          </html>
          EOF
          
      - name: Setup Pages
        uses: actions/configure-pages@v4
        
      - name: Upload artifact
        uses: actions/upload-pages-artifact@v3
        with:
          path: './dist'
          
  # Deployment job
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    needs: build
    if: github.ref == 'refs/heads/master'
    steps:
      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4